Stage 4 â€” Machine Learning Feature Extraction & Modeling

ğŸ¯ Má»¥c tiÃªu tá»•ng thá»ƒ

Tá»« file baseline
data/stage3_feature_stack.parquet
â†’ táº¡o ra feature matrix huáº¥n luyá»‡n, qua 3 lá»›p:

Stage
Má»¥c tiÃªu chÃ­nh
Output
4.1
Extract temporal features (tsfresh)
logs/stage4_tsfresh_features.csv
4.2
Feature selection + sanitation
logs/stage4_selected_features.csv
4.3
Train LightGBM base model (v1)
logs/stage4_model_lgbm.txt
4.4
Evaluate backtest folds (WF / regime)
logs/stage4_backtest_results.txt
4.5
Model QA â†’ freeze baseline
data/stage4_model_baseline.txt


âš™ï¸ Stage 4.1 â€” Tsfresh Feature Extraction

Input:
data/stage3_feature_stack.parquet (296 996 Ã— 66)

Quy trÃ¬nh:
	1.	Load subset cÃ¡c cá»™t giÃ¡ (px_gbpusd_close, px_eurusd_close, â€¦)
	2.	Normalize & chunk theo session.
	3.	Apply tsfresh.extract_features
vá»›i cáº¥u hÃ¬nh EfficientFCParameters, n_jobsâ‰ˆ28.
	4.	Sanitize tÃªn cá»™t (theo quy táº¯c Stage 2).
	5.	Save â†’ logs/stage4_tsfresh_features.csv.

Output:
Feature frame (â‰ˆ 10 000 â€“ 20 000 columns), time-aligned vá»›i label index.


ğŸ”’ Kiá»ƒm soÃ¡t cháº¥t lÆ°á»£ng
	â€¢	Chá»‰ extract trÃªn trainable samples (target_is_trainable = 1).
	â€¢	Bá» vÃ¹ng NaN/flat session Ä‘á»ƒ trÃ¡nh overfit.
	â€¢	Sau khi cháº¡y xong Stage 4.1, cháº¡y script QA nhá»:

python3 src/stage4/stage4_1b_audit_features.py

Ä‘á»ƒ xÃ¡c nháº­n:
	â€¢	sá»‘ lÆ°á»£ng feature,
	â€¢	tá»· lá»‡ NaN,
	â€¢	top variance,
	â€¢	runtime efficiency.