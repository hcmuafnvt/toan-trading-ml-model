Stage con
TÃªn
Má»¥c tiÃªu chÃ­nh
Output (baseline)
2.1
Time Alignment Engine
Chuáº©n hÃ³a toÃ n bá»™ thá»i gian giá»¯a cÃ¡c nguá»“n: OANDA M5, Calendar, Macro, Liquidity â†’ táº¥t cáº£ UTC, align theo nearest-event hoáº·c forward-fill logic.
data/fx_timegrid.parquet (khung thá»i gian chÃ­nh)
2.2
Event Fusion (Calendar â†’ FX)
Map cÃ¡c sá»± kiá»‡n kinh táº¿ vÃ o tá»«ng timestamp giÃ¡. VÃ­ dá»¥: trong Â±30 phÃºt quanh event, táº¡o feature: event_impact, event_zscore, is_event_window.
data/features_calendar_fx.parquet
2.3
Macro Fusion (Yields, Spreads â†’ FX)
Resample macro drivers (daily â†’ M5), dÃ¹ng forward-fill hoáº·c EMA-smoothing, thÃªm cÃ¡c derivative features (change rate, z-score).
data/features_macro_fx.parquet
2.4
Liquidity Fusion (Funding â†’ FX)
Gáº¯n cÃ¡c biáº¿n liquidity (Fed BS, RRP, SOFR spread, composite) vÃ o timegrid, thÃªm lag/rolling features.
data/features_liquidity_fx.parquet
2.5
Technical Indicators (Price-based)
TÃ­nh cÃ¡c feature truyá»n thá»‘ng (EMA, RSI, ATR, volatility, returns, range ratio, volume delta, etc.).
data/features_price_tech.parquet
2.6
Feature Unification & Sanitization
Gá»™p toÃ n bá»™ feature set láº¡i thÃ nh má»™t DataFrame, kiá»ƒm tra NaN, duplicate, outlier; chuáº©n hÃ³a cá»™t (snake_case, clean names).
logs/stage2_features.csv (chuáº©n pipeline)
2.7
Feature Quality Diagnostics
ÄÃ¡nh giÃ¡ completeness, variance, correlation, redundancy. Loáº¡i bá» feature noise trÆ°á»›c khi ML train.
logs/stage2_diagnostics.txt + chart
2.8
Baseline Freeze & Documentation
XÃ¡c nháº­n final feature matrix Ä‘áº¡t chuáº©n ML training (â‰¥ 99 % non-missing, normalized), Ä‘Ã³ng bÄƒng dataset vÃ  sinh Stage 2 Summary Doc.
data/stage2_feature_matrix.parquet + DOCX summary

Chiáº¿n lÆ°á»£c ká»¹ thuáº­t chá»§ Ä‘áº¡o
	1.	Time Index:
	â€¢	DÃ¹ng timegrid M5 lÃ m master.
	â€¢	CÃ¡c nguá»“n daily (macro, liquidity) â†’ forward-fill hoáº·c apply at 00:00 UTC.
	â€¢	CÃ¡c event (timestamp) â†’ align nearest candle Â±30 m (configurable).
	2.	Feature Value Transformation:
	â€¢	Chuáº©n hÃ³a cÃ¡c giÃ¡ trá»‹ (z-score hoáº·c rank).
	â€¢	Táº¡o thÃªm cÃ¡c feature temporal (lag1, lag3, diff).
	3.	Data Sanitization:
	â€¢	Replace early_stopping_rounds báº±ng callbacks (Stage 3 compat).
	â€¢	Clean tÃªn cá»™t ([^A-Za-z0-9_]+ â†’ _).
	â€¢	Validate khÃ´ng NaN, khÃ´ng Inf.
	4.	Output Consistency:
	â€¢	Má»i stage 2.x Ä‘á»u lÆ°u á»Ÿ data/ hoáº·c logs/ Ä‘Ãºng quy Æ°á»›c AlphaForge.
	â€¢	Má»—i sub-stage chá»‰ sinh 1 file baseline duy nháº¥t.

â¸»

ğŸ“ˆ Káº¿t quáº£ mong Ä‘á»£i khi hoÃ n táº¥t Stage 2
	â€¢	Dataset duy nháº¥t, dáº¡ng time-series, vá»›i:
	â€¢	~1000 feature/observation.
	â€¢	Äá»“ng bá»™ vÄ© mÃ´ + vi mÃ´ + technical.
	â€¢	KhÃ´ng NaN, khÃ´ng drift timestamp.
	â€¢	Sáºµn sÃ ng feed vÃ o Stage 3 â€” Model Train & Alpha Backtest.

â¸»

TÃ´i sáº½ báº¯t Ä‘áº§u Stage 2.1 â€“ Time Alignment Engine, nÆ¡i ta build khung thá»i gian master fx_timegrid tá»« dá»¯ liá»‡u OANDA M5.
ğŸ‘‰ Báº¡n cÃ³ muá»‘n tÃ´i generate luÃ´n script khá»Ÿi táº¡o src/stage2_1_time_alignment.py (Ä‘áº·t baseline cho Stage 2)?


=============


Nháº¯c láº¡i vá»‹ trÃ­ hiá»‡n táº¡i trong Stage 2:
	â€¢	2.1: fx_timegrid âœ… (táº¡o lÆ°á»›i thá»i gian M5 chuáº©n tá»« GBP_USD_M5_std.parquet)
	â€¢	2.2: sync price series vÃ o lÆ°á»›i thá»i gian â†’ giÃ¡, volume
	â€¢	2.3: sync cÃ¡c driver vÄ© mÃ´ (macro_fxdrivers.parquet)
	â€¢	2.4: sync liquidity_funding.parquet
	â€¢	2.5: sync econ_calendar_features.parquet (cÃ¡c event high-impact)
â†’ Káº¿t quáº£ gom láº¡i 1 DataFrame time-series M5 Ä‘áº§y Ä‘á»§ kiá»ƒu â€œfeature store thÃ´â€.

BÃ¢y giá» lÃ m bÆ°á»›c káº¿ tiáº¿p: Stage 2.2 â€“ merge giÃ¡ vÃ o fx_timegrid.

Má»¥c tiÃªu Stage 2.2
	â€¢	Äá»c fx_timegrid.parquet (Ä‘Ã£ táº¡o).
	â€¢	Äá»c tá»«ng cáº·p price chuáº©n hÃ³a *_M5_std.parquet (GBP, EUR, JPY, XAU).
	â€¢	Resample cÃ¡c cáº·p nÃ y lÃªn full lÆ°á»›i thá»i gian M5 (forward-fill giá»¯a cÃ¡c gap).
	â€¢	Gáº¯n chÃºng vÃ o fx_timegrid vá»›i prefix theo cáº·p, vÃ­ dá»¥:
	â€¢	gbpusd_close, gbpusd_volume
	â€¢	eurusd_close, eurusd_volume
	â€¢	usdjpy_close, usdjpy_volume
	â€¢	xauusd_close, xauusd_volume
	â€¢	LÆ°u output má»›i: data/stage2_prices_merged.parquet